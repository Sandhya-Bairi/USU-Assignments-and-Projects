package com.usu.stockMonitoring.observerForms;

import java.awt.Color;
import java.awt.Component;
import java.awt.FlowLayout;

import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.border.LineBorder;
import javax.swing.table.DefaultTableModel;

import com.usu.stocks.Portfolio;
import com.usu.stocks.subjectObserver.StocksObserver;

public class PortfolioStockPricePanelObserver extends StocksObserver {
	
	public PortfolioStockPricePanelObserver() {
		stock.registerStockOberserver(this);
	}

	@Override
	public void update(Portfolio portfolios) {
		int row = 0;
		Object[][] object = new Object[portfolios.size()][4];
		for (String stockSymbol : portfolios.keySet()) {
			/*((DefaultTableModel)table.getModel()).setValueAt(portfolios.get(stockSymbol).symbol, row, 0);
			((DefaultTableModel)table.getModel()).setValueAt(portfolios.get(stockSymbol).currentPrice, row, 1);
			((DefaultTableModel)table.getModel()).setValueAt(portfolios.get(stockSymbol).bidPrice, row, 2);
			((DefaultTableModel)table.getModel()).setValueAt(portfolios.get(stockSymbol).askPrice, row, 3);
			((DefaultTableModel)table.getModel()).fireTableDataChanged();*/
			object[row][0] = portfolios.get(stockSymbol).symbol;
			object[row][1] = portfolios.get(stockSymbol).currentPrice;
			object[row][2] = portfolios.get(stockSymbol).bidPrice;
			object[row][3] = portfolios.get(stockSymbol).askPrice;
			row++;
		}
		createNewTable(object);
	}
	
	private void createNewTable(Object[][] object) {
		JPanel panel = new JPanel();
		panel.setBackground(Color.WHITE);
		panel.setForeground(Color.BLUE);
		panel.setBounds(10, 40, 310, 230);
		frmStockPriceMonitoring.getContentPane().add(panel);
		panel.setLayout(new FlowLayout(FlowLayout.LEFT, 5, 5));
		
		table = new JTable(object, new String[] {"Stock", "Current", "Bid", "Ask Price"});
		table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
		table.setBorder(new LineBorder(new Color(0, 0, 0), 1, true));
		table.setAlignmentY(Component.TOP_ALIGNMENT);
		table.setAlignmentX(Component.LEFT_ALIGNMENT);
		//panel.add(table);
		table.setBackground(new Color(255, 250, 250));
		table.setShowGrid(true);
		table.setRowSelectionAllowed(false);
		/*table.setModel(new DefaultTableModel(
			new Object[][] {{null, null, null, null}, },
			new String[] {"Stock", "Current", "Bid", "Ask Price"}
		) {
			Class[] columnTypes = new Class[] {
				String.class, Integer.class, Integer.class, Integer.class, Integer.class
			};
			public Class getColumnClass(int columnIndex) {
				return columnTypes[columnIndex];
			}
		});*/
		
		JScrollPane scrollPane = new JScrollPane(table);
		scrollPane.setEnabled(false);
		scrollPane.setBounds(10, 40, 310, 230);
		scrollPane.setViewportView(table);
		panel.add(scrollPane);
	}
}